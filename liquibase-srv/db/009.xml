<databaseChangeLog xmlns='http://www.liquibase.org/xml/ns/dbchangelog'
  xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
  xsi:schemaLocation='http://www.liquibase.org/xml/ns/dbchangelog
    http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd'>
  <changeSet id="009" author="ur">
    <sql>
      CREATE VIEW animal.breed_count AS
      SELECT c.id, c.breed,
      CASE
      WHEN a.breedId=1 THEN COUNT(a.breedId)
      WHEN a.breedId=2 THEN COUNT(a.breedId)
      WHEN a.breedId=3 THEN COUNT(a.breedId)
      WHEN a.breedId=4 THEN COUNT(a.breedId)
      ELSE COUNT(NULL)
      END as 'Breed Count'
      FROM animal.dog as a
      JOIN animal.breedLookup as c ON c.id = a.breedId
      GROUP BY a.breedId;
    </sql>
  </changeSet>
</databaseChangeLog>
